---
import type { CollectionEntry } from 'astro:content';

interface Props {
  resource: CollectionEntry<'resources'>;
}

const { resource } = Astro.props;
const { title, description, category, priceRange, pros, cons, links, featured, image } = resource.data;

const categoryLabels = {
  devices: 'Device',
  accessories: 'Accessory',
  software: 'Software',
  firmware: 'Firmware',
  community: 'Community',
};
---

<article class:list={['card', featured && 'border-accent-300 border-2']}>
  {featured && (
    <div class="bg-accent-500 text-white text-xs font-semibold px-3 py-1 text-center">
      Recommended
    </div>
  )}
  
  {image && (
    <div class="aspect-video bg-neutral-100 overflow-hidden">
      <img src={image} alt={title} class="w-full h-full object-cover" loading="lazy" />
    </div>
  )}

  <div class="card-body">
    <div class="flex items-start justify-between gap-3 mb-3">
      <h3 class="text-xl font-semibold text-neutral-900">{title}</h3>
      <span class="badge-secondary shrink-0">{categoryLabels[category]}</span>
    </div>

    <p class="text-neutral-600 mb-4">{description}</p>

    {priceRange && (
      <div class="text-sm font-medium text-primary-600 mb-3">
        ðŸ’° {priceRange}
      </div>
    )}

    {(pros.length > 0 || cons.length > 0) && (
      <div class="grid sm:grid-cols-2 gap-4 mb-4 text-sm">
        {pros.length > 0 && (
          <div>
            <h4 class="font-medium text-green-700 mb-1">Pros</h4>
            <ul class="space-y-1">
              {pros.map((pro) => (
                <li class="flex items-start gap-2 text-neutral-600">
                  <svg class="w-4 h-4 text-green-500 mt-0.5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  {pro}
                </li>
              ))}
            </ul>
          </div>
        )}
        {cons.length > 0 && (
          <div>
            <h4 class="font-medium text-red-700 mb-1">Cons</h4>
            <ul class="space-y-1">
              {cons.map((con) => (
                <li class="flex items-start gap-2 text-neutral-600">
                  <svg class="w-4 h-4 text-red-500 mt-0.5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                  {con}
                </li>
              ))}
            </ul>
          </div>
        )}
      </div>
    )}

    {links.length > 0 && (
      <div class="flex flex-wrap gap-2 pt-3 border-t border-neutral-100">
        {links.map((link) => (
          <a
            href={link.url}
            target="_blank"
            rel="noopener noreferrer"
            class:list={[
              'btn-sm',
              link.type === 'purchase' ? 'btn-primary' : 'btn-outline',
            ]}
          >
            {link.label}
            <svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
          </a>
        ))}
      </div>
    )}
  </div>
</article>
